App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =// Patch for the approve button
        
        /*Patch(
            LRequests,              
            LookUp(LRequests, ID = ThisItem.ID), 
            {Status: "Approved"} 
        )*/
        
        
        If(
            !IsBlank(Param("ID")),
            Set(
                varItem,
                LookUp(
                    LeaveRequestsList,
                    ID = Value(Param("ID"))
                )
            );
            Set(
                varFormMode,
                FormMode.Edit
            )
        );
        //Setting a date variable 
        Set(
            MyDate,
            Today()
        );
        Set(
            VarUser,
            User()
        );
        //Collection used for company holidays collection
        ClearCollect(
            CompanyHolidays,
            {
                HolidayName: "Jamhuri day",
                StartDate: DateValue("12/12/2023")
            },
            {
                HolidayName: "Mashujaa day",
                StartDate: DateValue("10/20/2023")
            },
            {
                HolidayName: "Christmas",
                StartDate: DateValue("12/25/2023")
            },
            {
                HolidayName: "Boxing day",
                StartDate: DateValue("12/26/2023")
            },
            {
                HolidayName: "New Year's day",
                StartDate: DateValue("1/1/2024")
            }
        );
        //collection used in the left nav menu employee view
        ClearCollect(
            EmployeeNav,
            {
                Title: "My Leave Requests",
                TargetScreen: MyLeaveRequests
            },
            {
                Title: "My Leave Balance",
                TargetScreen: MyLeaveBalance
            },
            {
                Title: "Company Holidays",
                TargetScreen: CompanyHolidaysScreen
            },
            {
                Title: "About",
                TargetScreen: AboutScreen
            },
            {
                Title: "Log out",
                TargetScreen: LoginScreen
            }
        );
        
        //collection used in the left nav menu manager view
        ClearCollect(
            ManagerViewNav,
            {
                Title: "Leave Requests",
                TargetScreen: ManagerRequests
            },
            
            {
                Title: "Company Holidays",
                TargetScreen: CompanyHolidaysManager
            },
            {
                Title: "About",
                TargetScreen: AboutScreenManager
            },
            {
                Title: "Log out",
                TargetScreen: LoginScreen
            }
        );
        
        ///About
        ClearCollect(
            LeaveTypeCollection,
            Table(
                {
                    type: "Vacation leave",
                    description: "Vacation leave is provided to all employees for the purpose of rest, relaxation, and to attend to personal affairs. Vacation balance is acquired over time and can be used at any time."
                },
                {
                    type: "Sick Leave",
                    description: "Sick leave may be used for your own illness or medical/dental appointments or for the illness or medical/dental appointments of family members. Sick leave can also be used to address the psychological, physical, or legal aspects of domestic violence, sexual assault, stalking, or other crime. You may not use sick leave for vacation purposes. Some cities and states have specific laws governing sick leave that allow use of sick leave to care for other family members."
                },
                {
                    type: "Maternity leave",
                    description: "Maternity leave is a specific type of leave provided to female employees who are expecting a baby. It's designed to ensure that mothers have the necessary time to focus on their health during pregnancy, deliver the baby, and bond with and care for their newborn.."
                },
                {
                    type: "Paternity leave",
                    description: "Paternity leave is a workplace benefit designed to support male employees when they become fathers or adopt children. It allows fathers to take time off from work to bond with their newborn or adopted child, provide support to their partner or spouse, and participate in the early stages of their child's life. Here's an explanation of paternity leave for an employee:."
                },
                {
                    type: "Bereavement leave",
                    description: " is a specific type of employee benefit or workplace policy that allows employees to take time off from work when they experience the loss of a loved one. This leave is designed to provide employees with the necessary time to grieve, make funeral arrangements, and attend to family matters without the added stress of work responsibilities. a"
                }
            )
        )
    StartScreen: |-
        =//If(!IsBlank(Param("ID")) && LookUp(LeaveRequestsList,ID=Value(Param("ID"))).AssignedTo = User().Email,//NewRequests_1,MyLeaveRequests)
        If(User().Email = "Lillian.Warui@betahood.tech",ManagerRequests,MyLeaveRequests)
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

